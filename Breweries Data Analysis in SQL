SQL BREWERIES PROJECT



-- 1. Within the space of the last three years, what was the profit worth of the brewrie 

  SELECT sum(PROFIT)
    FROM brewries.breweries
    WHERE YEARS IN (2017, 2018, 2019);
    
    -- 2. SHOW IN DESCENDING ORDER, THE TOTAL PROFIT MADE BY EACH COUNTRY
    
    SELECT COUNTRIES, SUM(PROFIT)
    FROM brewries.breweries
    GROUP BY COUNTRIES 
    ORDER BY SUM(PROFIT) DESC;
    
   -- 3. WHICH COUNTRY GENERATED THE HIGHEST PROFIT IN 2019
   
    SELECT COUNTRIES, SUM(PROFIT)
    FROM brewries.breweries
    WHERE YEARS = '2019'
    GROUP BY COUNTRIES 
    ORDER BY SUM(PROFIT) DESC
    LIMIT 1;
    
    -- 4. HELP MR STONE, YOUR LINE MNAGER, TO FIND TH YEAR WITH THE HIGHEST PROFIT
    
    SELECT YEARS, SUM(PROFIT) HIGHEST_PROFIT
    FROM brewries.breweries
    GROUP BY YEARS 
    ORDER BY SUM(PROFIT) DESC
    LIMIT 1;
    
    -- 5. WHICH MONTH IN THE THREE YEARS WAS THE LEAST PROFIT GENERATED
    
    SELECT MONTHS, YEARS, PROFIT
    FROM brewries.breweries
    ORDER BY PROFIT
    LIMIT 1;
    
    -- 6. WHAT WAS THE MINIMUM PROFIT IN THE MONTH OF DECEMBER 2018
    
    SELECT MONTHS, YEARS, PROFIT
    FROM brewries.breweries
    WHERE MONTHS = 'DECEMBER' AND YEARS = '2018'
    ORDER BY PROFIT
    LIMIT 1; 
    
    -- 7. COMPARE THE PROFIT IN PERCENTAGE FOR EACH OF THE MONTHS IN 2019
    
    SELECT years, SUM(profit)
  FROM brewries.breweries
  WHERE years = '2019';
    
  SELECT MONTHS,  YEARS, SUM(PROFIT) MONTHLY_PROFIT_PER_MONTH, (SUM(PROFIT)/30020250) * 100 PROFIT_PERCENTAGE
    FROM brewries.breweries
    WHERE YEARS  = 2019
  GROUP BY MONTHS;
    
    -- 8. WHICH PARTICULAR BRAND GENERATED THE HIGHEST PROFIT IN SENEGAL
    
    SELECT BRANDS, COUNTRIES, SUM(PROFIT) HIGHEST_PROFIT
    FROM brewries.breweries
    WHERE COUNTRIES = 'Senegal'
    GROUP BY BRANDS
    ORDER BY 3 DESC
    LIMIT 1;
    
    -- SECTION B BRAND ANALYSIS
    
    -- 1. FIND OUT THE TOP TWO CHOICES OF CONSUMER BRANDS IN GHANA
    
    SELECT BRANDS, SUM(QUANTITY) QUANTITY_SOLD, COUNTRIES
    FROM brewries.breweries
    WHERE COUNTRIES = 'GHANA'
    GROUP BY BRANDS 
    ORDER BY 2 DESC
    LIMIT 2;
    
    -- 2. FIND OUT THE DETAILS OF BEERS CONSUMED IN THE PAST THREE YEARS IN THE MOST OIL-RICH COUNTRY IN WEST AFRICA (NIGERIA)
    
    SELECT COUNTRIES, SUM(QUANTITY) BEERS_CONSUMED, YEARS
    FROM brewries.breweries
    WHERE COUNTRIES = 'NIGERIA' AND BRANDS NOT LIKE '%MALT'
    GROUP BY 3
    ORDER BY 3 DESC;
    
    -- 3. WHICH BRANDS SOLD THE HIGHEST IN 2019 IN NIGERIA
    
    SELECT BRANDS, SUM(QUANTITY) QTY_SOLD, YEARS 
    FROM brewries.breweries
    WHERE COUNTRIES = 'NIGERIA' AND YEARS = 2019
    GROUP BY 1
    ORDER BY 2 DESC;
    
    -- 4. WHAT IS THE TOTAL CONSUMPTION OF THE TOP THREE BRANDS IN THE SOUTH-SOUTH REGION OF NIGERIA
    
    SELECT BRANDS, SUM(QUANTITY) TOTAL_CONSUMPTION, REGION, COUNTRIES 
    FROM brewries.breweries
    WHERE REGION = 'southsouth' AND COUNTRIES = 'NIGERIA'
    GROUP BY 1, 3
    ORDER BY 2 DESC;
    
    -- 5. FIND THE TOTAL CONSUMPTION OF BEER IN NIGERIA
    
    SELECT COUNTRIES, SUM(QUANTITY) TOTAL_CONSUMPTION_NIGERIA
    FROM brewries.breweries
    WHERE COUNTRIES = 'NIGERIA' AND BRANDS NOT LIKE '%MALT';
    
    -- 6. LEVEL OF CONSUMPTION OF BUDWEISER IN THE REGIONS OF NIGERIA
    
    SELECT BRANDS, REGION, COUNTRIES, SUM(QUANTITY)
    FROM brewries.breweries
    WHERE BRANDS = 'BUDWEISER' AND COUNTRIES = 'NIGERIA'
    GROUP BY 1, 2
    ORDER BY 4 DESC;
    
    -- 7. LEVEL OF CONSUMPTION OF BUDWEISER IN THE REGIONS OF NIGERIA IN 2019
    
    SELECT BRANDS, REGION, COUNTRIES, SUM(QUANTITY)
    FROM brewries.breweries
    WHERE BRANDS = 'BUDWEISER' AND COUNTRIES = 'NIGERIA'
    GROUP BY 1, 2
    ORDER BY 4 DESC;
    
    -- SECTION C COUNTRIES ANALYSES
    
    -- 1. WHICH CONTRY HAS THE HIGHEST CONSUMPTION OF BEER
    
    SELECT COUNTRIES, SUM(QUANTITY) BEER_CONSUMPTION
    FROM brewries.breweries
    WHERE BRANDS NOT LIKE '%MALT'
    GROUP BY 1
    ORDER BY 2 DESC;
    
    
    -- 2. SHOW THE TOP THREE SALES PERSONNEL
    
    SELECT SALES_REP, SUM(QUANTITY) QUANTITY_SOLD

    FROM brewries.breweries
    GROUP BY 1
    ORDER BY 2 DESC
    LIMIT 3;
    
    -- 3. COUNTRY WITH THE HIGHEST PROFIT OF THE FOURTH QUARTER IN 2019
    
    SELECT COUNTRIES, SUM(PROFIT) HIGHEST_PROFIT 
    FROM brewries.breweries
    WHERE MONTHS IN ('OCTOBER', 'NOVEMBER', 'DECEMBER') AND YEARS = 2019
    GROUP BY 1
    ORDER BY 2 DESC;
